<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Êº¢Â≠óÈÉ®È¶ñ ¬∑ Kanji Radicals</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Shippori+Mincho:wght@400;700&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1208;
    --ink2: #2d2010;
    --paper: #f5eedf;
    --paper2: #ede3ce;
    --paper3: #e0d4ba;
    --brush: #1a1208;
    --red: #c0392b;
    --gold: #b8860b;
    --gold2: #d4a017;
    --guide: rgba(180,140,80,0.18);
    --stroke-color: #2c5f8a;
    --num-color: #c0392b;
    --shadow: rgba(26,18,8,0.25);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

  html, body {
    height: 100%; overflow: hidden;
    background: var(--ink);
    font-family: 'Crimson Pro', Georgia, serif;
    color: var(--ink);
    touch-action: none;
  }

  /* ‚îÄ‚îÄ NOISE TEXTURE ‚îÄ‚îÄ */
  body::before {
    content: '';
    position: fixed; inset: 0; z-index: 0; pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    opacity: 0.5;
  }

  #app {
    position: fixed; inset: 0; z-index: 1;
    display: flex; flex-direction: column;
  }

  /* ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ */
  #topbar {
    background: var(--ink2);
    display: flex; align-items: center; justify-content: space-between;
    padding: 8px 14px;
    border-bottom: 1px solid rgba(180,140,80,0.3);
    flex-shrink: 0;
    gap: 8px;
  }

  #topbar h1 {
    font-family: 'Noto Serif JP', serif;
    color: var(--gold2);
    font-size: 1.1rem;
    font-weight: 700;
    letter-spacing: 0.03em;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .top-controls {
    display: flex; align-items: center; gap: 8px; flex-wrap: wrap; justify-content: flex-end;
  }

  select, button.pill {
    background: rgba(180,140,80,0.12);
    border: 1px solid rgba(180,140,80,0.35);
    color: var(--paper);
    padding: 4px 10px;
    border-radius: 20px;
    font-family: 'Crimson Pro', serif;
    font-size: 0.85rem;
    cursor: pointer;
    outline: none;
    transition: background 0.2s;
  }
  select:hover, button.pill:hover { background: rgba(180,140,80,0.25); }
  select option { background: var(--ink2); color: var(--paper); }

  /* ‚îÄ‚îÄ VIEWS ‚îÄ‚îÄ */
  #grid-view, #study-view {
    flex: 1; overflow: hidden; display: flex; flex-direction: column;
  }

  /* ‚îÄ‚îÄ GRID VIEW ‚îÄ‚îÄ */
  #grid-header {
    background: var(--ink2);
    padding: 8px 14px;
    display: flex; align-items: center; gap: 10px;
    border-bottom: 1px solid rgba(180,140,80,0.2);
    flex-shrink: 0;
  }
  #grid-header span { color: var(--paper2); font-size: 0.85rem; }

  #stroke-filter {
    display: flex; gap: 4px; flex-wrap: wrap;
  }
  .sf-btn {
    background: rgba(180,140,80,0.1);
    border: 1px solid rgba(180,140,80,0.25);
    color: var(--paper2);
    padding: 3px 9px;
    border-radius: 12px;
    font-size: 0.78rem;
    cursor: pointer;
    transition: all 0.15s;
    font-family: 'Crimson Pro', serif;
  }
  .sf-btn.active {
    background: var(--gold);
    color: var(--ink);
    border-color: var(--gold);
    font-weight: 600;
  }

  #radical-grid {
    flex: 1; overflow-y: auto; padding: 10px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    align-content: start;
    background: var(--ink);
  }

  @media (min-width: 480px) {
    #radical-grid { grid-template-columns: repeat(5, 1fr); }
  }
  @media (min-width: 700px) {
    #radical-grid { grid-template-columns: repeat(7, 1fr); }
  }
  #radical-grid::-webkit-scrollbar { width: 4px; }
  #radical-grid::-webkit-scrollbar-thumb { background: rgba(180,140,80,0.3); border-radius: 2px; }

  .radical-card {
    background: var(--paper2);
    border-radius: 6px;
    padding: 10px 4px 8px;
    cursor: pointer;
    display: flex; flex-direction: column; align-items: center; gap: 3px;
    transition: transform 0.15s, box-shadow 0.15s;
    border: 1px solid rgba(180,140,80,0.3);
    position: relative;
    overflow: hidden;
    min-height: 80px;
    justify-content: center;
  }
  .radical-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 3px;
    background: linear-gradient(90deg, var(--gold), transparent);
    opacity: 0;
    transition: opacity 0.15s;
  }
  .radical-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px var(--shadow); }
  .radical-card:hover::before { opacity: 1; }
  .radical-card:active { transform: scale(0.95); }

  .rc-char {
    font-family: 'Noto Serif JP', serif;
    font-size: 2.2rem;
    line-height: 1;
    color: var(--ink);
    user-select: none;
  }
  .rc-num {
    font-size: 0.6rem;
    color: var(--gold);
    font-weight: 600;
    letter-spacing: 0.05em;
  }
  .rc-meaning {
    font-size: 0.62rem;
    color: #5a4020;
    text-align: center;
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    padding: 0 2px;
  }
  .rc-strokes {
    font-size: 0.58rem;
    color: rgba(90,64,32,0.6);
  }

  /* ‚îÄ‚îÄ STUDY VIEW ‚îÄ‚îÄ */
  #study-view {
    background: var(--ink);
  }

  #study-header {
    background: var(--ink2);
    padding: 8px 14px;
    display: flex; align-items: center; justify-content: space-between;
    border-bottom: 1px solid rgba(180,140,80,0.25);
    flex-shrink: 0;
  }

  #back-btn {
    background: none; border: none; color: var(--gold2);
    font-size: 1.1rem; cursor: pointer; padding: 4px 8px 4px 0;
    font-family: 'Crimson Pro', serif;
    display: flex; align-items: center; gap: 6px;
  }
  #back-btn:hover { color: var(--paper); }

  #radical-info {
    text-align: center; flex: 1;
  }
  #info-char {
    font-family: 'Noto Serif JP', serif;
    font-size: 1.6rem;
    color: var(--gold2);
    line-height: 1;
  }
  #info-meaning {
    font-size: 0.82rem;
    color: var(--paper2);
    font-style: italic;
  }
  #info-meta {
    font-size: 0.72rem;
    color: rgba(213,189,143,0.6);
  }

  .nav-btn {
    background: rgba(180,140,80,0.12);
    border: 1px solid rgba(180,140,80,0.3);
    color: var(--gold2);
    width: 34px; height: 34px;
    border-radius: 50%;
    font-size: 1rem;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: background 0.15s;
    flex-shrink: 0;
  }
  .nav-btn:hover { background: rgba(180,140,80,0.25); }

  #study-body {
    flex: 1; display: flex; flex-direction: column;
    overflow: hidden; gap: 0;
  }

  /* Reference section */
  #ref-section {
    background: var(--paper);
    flex-shrink: 0;
    padding: 10px;
    display: flex; align-items: center; justify-content: center; gap: 16px;
    border-bottom: 2px solid var(--paper3);
    position: relative;
  }

  #ref-section::after {
    content: attr(data-label);
    position: absolute; top: 4px; left: 10px;
    font-size: 0.6rem; color: rgba(90,64,32,0.4);
    letter-spacing: 0.1em; text-transform: uppercase;
    font-family: 'Crimson Pro', serif;
  }

  #stroke-order-container {
    width: 100px; height: 100px;
    position: relative;
    flex-shrink: 0;
  }

  #stroke-order-svg {
    width: 100%; height: 100%;
  }

  #stroke-order-fallback {
    width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Noto Serif JP', serif;
    font-size: 5rem;
    color: var(--ink);
    line-height: 1;
  }

  .stroke-legend {
    display: flex; flex-direction: column; gap: 4px;
  }
  .stroke-legend-item {
    display: flex; align-items: center; gap: 6px;
    font-size: 0.72rem; color: #5a4020;
  }
  .stroke-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: var(--num-color);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.5rem; color: white; font-weight: 700;
    flex-shrink: 0;
  }

  /* Meanings panel */
  #meanings-row {
    background: var(--paper3);
    padding: 8px 14px;
    display: flex; gap: 12px; flex-wrap: wrap; align-items: center;
    border-bottom: 1px solid rgba(180,140,80,0.3);
    flex-shrink: 0;
  }
  .meaning-item {
    display: flex; align-items: center; gap: 5px;
    font-size: 1.8rem;
  }
  .meaning-lang {
    font-size: 1.1rem; color: var(--gold);
    text-transform: uppercase; letter-spacing: 0.06em;
    font-weight: 600;
  }
  .meaning-text {
    color: var(--ink);
    font-style: italic;
    font-size: 1.8rem;
  }

  /* Canvas section */
  #canvas-section {
    flex: 1;
    background: var(--paper);
    position: relative;
    overflow: hidden;
    display: flex; align-items: center; justify-content: center;
  }

  #canvas-section::after {
    content: attr(data-hint);
    position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%);
    font-size: 0.65rem; color: rgba(90,64,32,0.4);
    white-space: nowrap;
    pointer-events: none;
    letter-spacing: 0.05em;
  }

  #guide-wrap {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #guide-char {
    font-family: 'Noto Serif JP', serif;
    color: #c0392b;
    user-select: none;
    pointer-events: none;
    transition: opacity 0.3s;
    line-height: 1;
    display: block;
    flex-shrink: 0;
  }

  #canvas-grid {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    z-index: 0; pointer-events: none;
  }

  #guide-canvas {
    display: none;
  }

  #guide-wrap {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
  }

  #guide-char {
    font-family: 'Noto Serif JP', serif;
    color: #c0392b;
    line-height: 1;
    user-select: none;
    pointer-events: none;
    transition: opacity 0.3s;
    display: block;
    flex-shrink: 0;
  }

  #draw-canvas {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    cursor: crosshair;
    z-index: 2;
    touch-action: none;
  }

  /* Grid lines on canvas */

  /* Clear flash */
  .clear-flash {
    position: absolute; inset: 0;
    background: rgba(180,140,80,0.15);
    z-index: 10; pointer-events: none;
    animation: flash 0.25s ease-out forwards;
  }
  @keyframes flash {
    0% { opacity: 1; }
    100% { opacity: 0; }
  }

  /* Brush size control */
  #brush-controls {
    position: absolute; top: 8px; right: 8px;
    display: flex; flex-direction: column; gap: 6px;
    z-index: 5;
  }
  .brush-btn {
    background: rgba(245,238,223,0.9);
    border: 1px solid rgba(180,140,80,0.4);
    border-radius: 50%;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s;
    flex-shrink: 0;
  }
  .brush-btn:hover { background: var(--paper2); }
  .brush-btn.active { background: var(--gold); border-color: var(--gold); }
  .brush-dot { border-radius: 50%; background: var(--ink); }

  /* Mode toggle */
  #mode-toggle {
    position: absolute; top: 8px; left: 8px;
    z-index: 5;
    display: flex; flex-direction: column; gap: 4px;
  }
  .mode-btn {
    background: rgba(245,238,223,0.9);
    border: 1px solid rgba(180,140,80,0.4);
    border-radius: 6px;
    padding: 4px 8px;
    font-size: 0.65rem;
    cursor: pointer;
    color: var(--ink);
    font-family: 'Crimson Pro', serif;
    transition: all 0.15s;
    white-space: nowrap;
  }
  .mode-btn.active { background: var(--ink); color: var(--gold2); border-color: var(--gold); }

  /* Loading spinner */
  .loading-ring {
    width: 40px; height: 40px;
    border: 3px solid rgba(180,140,80,0.2);
    border-top-color: var(--gold);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Swipe indicator */
  .swipe-hint {
    position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 4px; pointer-events: none; z-index: 5;
    opacity: 0; animation: fadeHint 2s 1s ease-in-out forwards;
  }
  @keyframes fadeHint { 0%{opacity:0} 20%{opacity:0.6} 80%{opacity:0.6} 100%{opacity:0} }

  /* Progress bar */
  #progress-bar {
    height: 2px;
    background: rgba(180,140,80,0.15);
    flex-shrink: 0;
  }
  #progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--gold), var(--gold2));
    transition: width 0.3s;
  }

  /* Responsive */
  @media (min-width: 600px) {
    #study-body { flex-direction: row; }
    #ref-section {
      flex-direction: column; width: 160px; flex-shrink: 0;
      border-bottom: none; border-right: 2px solid var(--paper3);
      height: 100%;
    }
    #stroke-order-container { width: 120px; height: 120px; }
    #meanings-row { flex-direction: column; align-items: flex-start; }
    #canvas-section { flex: 1; height: 100%; }
    /* guide char sized via vmin, no override needed */
  }

  .hidden { display: none !important; }
</style>
</head>
<body>
<div id="app">
  <!-- TOP BAR -->
  <div id="topbar">
    <h1>Êº¢Â≠óÈÉ®È¶ñ</h1>
    <div class="top-controls">
      <select id="lang-select">
        <option value="en">English</option>
        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
        <option value="de">Deutsch</option>
        <option value="fr">Fran√ßais</option>
        <option value="ja">Êó•Êú¨Ë™û</option>
      </select>
      <button class="pill" id="toggle-view-btn">üìñ Study</button>
    </div>
  </div>

  <!-- GRID VIEW -->
  <div id="grid-view">
    <div id="grid-header">
      <span id="grid-label">Strokes:</span>
      <div id="stroke-filter"></div>
    </div>
    <div id="radical-grid"></div>
  </div>

  <!-- STUDY VIEW -->
  <div id="study-view" class="hidden">
    <div id="progress-bar"><div id="progress-fill"></div></div>
    <div id="study-header">
      <button id="back-btn">‚Üê <span id="back-label">List</span></button>
      <div id="radical-info">
        <div id="info-char">‰∏Ä</div>
        <div id="info-meaning">one</div>
        <div id="info-meta">#1 ¬∑ 1 stroke</div>
      </div>
      <div style="display:flex;gap:6px">
        <button class="nav-btn" id="prev-btn">‚Üê</button>
        <button class="nav-btn" id="next-btn">‚Üí</button>
      </div>
    </div>

    <div id="study-body">
      <div id="ref-section" data-label="Reference">
        <div id="stroke-order-container">
          <div id="stroke-order-fallback"></div>
          <svg id="stroke-order-svg" viewBox="0 0 109 109" class="hidden"></svg>
        </div>
        <div class="stroke-legend" id="stroke-legend"></div>
      </div>

      <div id="meanings-row"></div>

      <div id="canvas-section" data-hint="">
        <canvas id="canvas-grid"></canvas>
        <div id="guide-wrap">
          <div id="guide-char"></div>
        </div>
        <canvas id="draw-canvas"></canvas>

        <div id="brush-controls">
          <button class="brush-btn active" id="b-thin" style="width:28px;height:28px" title="Thin">
            <div class="brush-dot" style="width:2px;height:2px"></div>
          </button>
          <button class="brush-btn" id="b-medium" style="width:28px;height:28px" title="Medium">
            <div class="brush-dot" style="width:5px;height:5px"></div>
          </button>
          <button class="brush-btn" id="b-thick" style="width:32px;height:32px" title="Thick">
            <div class="brush-dot" style="width:9px;height:9px"></div>
          </button>
        </div>

        <div id="mode-toggle">
          <button class="mode-btn active" id="mode-free" data-mode="free">‚úé Free</button>
          <button class="mode-btn" id="mode-over" data-mode="over">‚óé Trace</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DATA: ALL 214 KANGXI RADICALS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const RADICALS = [
  // 1 stroke
  {n:1,c:'‰∏Ä',s:1,en:'one',ru:'–æ–¥–∏–Ω',de:'eins',fr:'un',ja:'„ÅÑ„Å°',kun:'„Å≤„Å®'},
  {n:2,c:'‰∏®',s:1,en:'line',ru:'—á–µ—Ä—Ç–∞',de:'Linie',fr:'ligne',ja:'„Åº„ÅÜ',kun:'„Åü„Å¶„Åº„ÅÜ'},
  {n:3,c:'‰∏∂',s:1,en:'dot',ru:'—Ç–æ—á–∫–∞',de:'Punkt',fr:'point',ja:'„Å¶„Çì',kun:'„Å¶„Çì'},
  {n:4,c:'‰∏ø',s:1,en:'slash',ru:'–∫–æ—Å–∞—è —á–µ—Ä—Ç–∞',de:'Schr√§gstrich',fr:'barre',ja:'„ÅÆ',kun:'„ÅÆ„Åã„Åü„Å°'},
  {n:5,c:'‰πô',s:1,en:'second',ru:'–≤—Ç–æ—Ä–æ–π',de:'zweite',fr:'deuxi√®me',ja:'„Åä„Å§',kun:'„Åä„Å®'},
  {n:6,c:'‰∫Ö',s:1,en:'hook',ru:'–∫—Ä—é–∫',de:'Haken',fr:'crochet',ja:'„ÅØ„Å≠„Åº„ÅÜ',kun:'„ÅØ„Å≠'},
  // 2 strokes
  {n:7,c:'‰∫å',s:2,en:'two',ru:'–¥–≤–∞',de:'zwei',fr:'deux',ja:'„Å´',kun:'„Åµ„Åü'},
  {n:8,c:'‰∫†',s:2,en:'lid',ru:'–∫—Ä—ã—à–∫–∞',de:'Deckel',fr:'couvercle',ja:'„Å™„Åπ„Å∂„Åü',kun:'„Åµ„Åü'},
  {n:9,c:'‰∫∫',s:2,en:'person',ru:'—á–µ–ª–æ–≤–µ–∫',de:'Mensch',fr:'personne',ja:'„Å≤„Å®',kun:'„Å≤„Å®'},
  {n:10,c:'ÂÑø',s:2,en:'legs',ru:'–Ω–æ–≥–∏',de:'Beine',fr:'jambes',ja:'„Å´„Çì„Å´„Çá„ÅÜ',kun:'„ÅÇ„Åó'},
  {n:11,c:'ÂÖ•',s:2,en:'enter',ru:'–≤—Ö–æ–¥–∏—Ç—å',de:'eingehen',fr:'entrer',ja:'„ÅÑ„Çã',kun:'„ÅÑ„Çã'},
  {n:12,c:'ÂÖ´',s:2,en:'eight',ru:'–≤–æ—Å–µ–º—å',de:'acht',fr:'huit',ja:'„ÅØ„Å°',kun:'„ÇÑ„Å£„Å§'},
  {n:13,c:'ÂÜÇ',s:2,en:'wide',ru:'—à–∏—Ä–æ–∫–∏–π',de:'weit',fr:'large',ja:'„Åæ„Åç„Åå„Åæ„Åà',kun:'„Åë„ÅÑ„Åå„Åæ„Åà'},
  {n:14,c:'ÂÜñ',s:2,en:'cover',ru:'–ø–æ–∫—Ä—ã–≤–∞—Ç—å',de:'bedecken',fr:'couvrir',ja:'„Çè„Åã„Çì„ÇÄ„Çä',kun:'„Å™„Åπ„Å∂„Åü'},
  {n:15,c:'ÂÜ´',s:2,en:'ice',ru:'–ª—ë–¥',de:'Eis',fr:'glace',ja:'„Å´„Åô„ÅÑ',kun:'„Åì„Åä„Çä'},
  {n:16,c:'Âá†',s:2,en:'table',ru:'—Å—Ç–æ–ª',de:'Tisch',fr:'table',ja:'„Åç„Å´„Çá„ÅÜ',kun:'„Å§„Åè„Åà'},
  {n:17,c:'Âáµ',s:2,en:'open box',ru:'–æ—Ç–∫—Ä—ã—Ç–∞—è –∫–æ—Ä–æ–±–∫–∞',de:'offene Box',fr:'boite ouverte',ja:'„ÅÜ„Åë„Å∞„Åì',kun:'„ÅÜ„Åë„Å∞„Åì'},
  {n:18,c:'ÂàÄ',s:2,en:'knife',ru:'–Ω–æ–∂',de:'Messer',fr:'couteau',ja:'„Åã„Åü„Å™',kun:'„Åã„Åü„Å™'},
  {n:19,c:'Âäõ',s:2,en:'power',ru:'—Å–∏–ª–∞',de:'Kraft',fr:'force',ja:'„Å°„Åã„Çâ',kun:'„Å°„Åã„Çâ'},
  {n:20,c:'Âãπ',s:2,en:'wrap',ru:'–æ–±—ë—Ä—Ç–∫–∞',de:'H√ºlle',fr:'enveloppe',ja:'„Å§„Å§„Åø„Åå„Åæ„Åà',kun:'„Å§„Å§„Åø'},
  {n:21,c:'Âåï',s:2,en:'spoon',ru:'–ª–æ–∂–∫–∞',de:'L√∂ffel',fr:'cuiller',ja:'„Åï„Åò',kun:'„Åï„Åò'},
  {n:22,c:'Âåö',s:2,en:'box',ru:'–∫–æ—Ä–æ–±–∫–∞',de:'Kiste',fr:'bo√Æte',ja:'„ÅØ„Åì„Åå„Åæ„Åà',kun:'„ÅØ„Åì'},
  {n:23,c:'Âå∏',s:2,en:'hiding',ru:'–ø—Ä—è—Ç–∞—Ç—å',de:'verbergen',fr:'cacher',ja:'„Åã„Åè„Åó„Åå„Åæ„Åà',kun:'„Åã„Åè„Åô'},
  {n:24,c:'ÂçÅ',s:2,en:'ten',ru:'–¥–µ—Å—è—Ç—å',de:'zehn',fr:'dix',ja:'„Åò„ÇÖ„ÅÜ',kun:'„Å®„Åä'},
  {n:25,c:'Âçú',s:2,en:'divination',ru:'–≥–∞–¥–∞–Ω–∏–µ',de:'Divination',fr:'divination',ja:'„Åº„Åè',kun:'„ÅÜ„Çâ„Å™„ÅÑ'},
  {n:26,c:'Âç©',s:2,en:'seal',ru:'–ø–µ—á–∞—Ç—å',de:'Siegel',fr:'sceau',ja:'„Åµ„Åó„Å•„Åè„Çä',kun:'„Åµ„Åó'},
  {n:27,c:'ÂéÇ',s:2,en:'cliff',ru:'—É—Ç—ë—Å',de:'Felswand',fr:'falaise',ja:'„Åå„Çì„Å†„Çå',kun:'„Åç„Åó'},
  {n:28,c:'Âé∂',s:2,en:'private',ru:'—á–∞—Å—Ç–Ω—ã–π',de:'privat',fr:'priv√©',ja:'„ÇÄ',kun:'„Çè„Åü„Åè„Åó'},
  {n:29,c:'Âèà',s:2,en:'again',ru:'—Å–Ω–æ–≤–∞',de:'wieder',fr:'encore',ja:'„Åæ„Åü',kun:'„Åæ„Åü'},
  // 3 strokes
  {n:30,c:'Âè£',s:3,en:'mouth',ru:'—Ä–æ—Ç',de:'Mund',fr:'bouche',ja:'„Åè„Å°',kun:'„Åè„Å°'},
  {n:31,c:'Âõó',s:3,en:'enclosure',ru:'–æ–≥—Ä–∞–∂–¥–µ–Ω–∏–µ',de:'Einz√§unung',fr:'enclos',ja:'„Åè„Å´„Åå„Åæ„Åà',kun:'„Åã„Åì„ÅÑ'},
  {n:32,c:'Âúü',s:3,en:'earth',ru:'–∑–µ–º–ª—è',de:'Erde',fr:'terre',ja:'„Å§„Å°',kun:'„Å§„Å°'},
  {n:33,c:'Â£´',s:3,en:'scholar',ru:'—É—á—ë–Ω—ã–π',de:'Gelehrter',fr:'lettr√©',ja:'„Åï„ÇÄ„Çâ„ÅÑ',kun:'„Åï„ÇÄ„Çâ„ÅÑ'},
  {n:34,c:'Â§Ç',s:3,en:'go',ru:'–∏–¥—Ç–∏',de:'gehen',fr:'aller',ja:'„Åµ„ÇÜ„Åå„Åó„Çâ',kun:'„Åä„Åè„Çå„Çã'},
  {n:35,c:'Â§ä',s:3,en:'walk slowly',ru:'–∏–¥—Ç–∏ –º–µ–¥–ª–µ–Ω–Ω–æ',de:'langsam gehen',fr:'aller lentement',ja:'„Åô„ÅÑ„Å´„Çá„ÅÜ',kun:'„ÇÜ„Å£„Åè„Çä'},
  {n:36,c:'Â§ï',s:3,en:'evening',ru:'–≤–µ—á–µ—Ä',de:'Abend',fr:'soir',ja:'„ÇÜ„ÅÜ„Åπ',kun:'„ÇÜ„ÅÜ'},
  {n:37,c:'Â§ß',s:3,en:'big',ru:'–±–æ–ª—å—à–æ–π',de:'gro√ü',fr:'grand',ja:'„Å†„ÅÑ',kun:'„Åä„Åä„Åç„ÅÑ'},
  {n:38,c:'Â•≥',s:3,en:'woman',ru:'–∂–µ–Ω—â–∏–Ω–∞',de:'Frau',fr:'femme',ja:'„Åä„Çì„Å™',kun:'„Åä„Çì„Å™'},
  {n:39,c:'Â≠ê',s:3,en:'child',ru:'—Ä–µ–±—ë–Ω–æ–∫',de:'Kind',fr:'enfant',ja:'„Åì',kun:'„Åì'},
  {n:40,c:'ÂÆÄ',s:3,en:'roof',ru:'–∫—Ä—ã—à–∞',de:'Dach',fr:'toit',ja:'„ÅÜ„Åã„Çì„ÇÄ„Çä',kun:'„ÇÑ„Å≠'},
  {n:41,c:'ÂØ∏',s:3,en:'inch',ru:'–¥—é–π–º',de:'Zoll',fr:'pouce',ja:'„Åô„Çì',kun:'„Åô„Åì„Åó'},
  {n:42,c:'Â∞è',s:3,en:'small',ru:'–º–∞–ª–µ–Ω—å–∫–∏–π',de:'klein',fr:'petit',ja:'„Åó„Çá„ÅÜ',kun:'„Å°„ÅÑ„Åï„ÅÑ'},
  {n:43,c:'Â∞¢',s:3,en:'lame',ru:'—Ö—Ä–æ–º–æ–π',de:'lahm',fr:'boiteux',ja:'„Åæ„Åí„ÅÇ„Åó',kun:'„Åæ„Åí'},
  {n:44,c:'Â∞∏',s:3,en:'corpse',ru:'—Ç—Ä—É–ø',de:'Leichnam',fr:'cadavre',ja:'„Åó„Åã„Å∞„Å≠',kun:'„Åã„Åü„Å°'},
  {n:45,c:'Â±Æ',s:3,en:'sprout',ru:'—Ä–æ—Å—Ç–æ–∫',de:'Keim',fr:'bourgeon',ja:'„Å¶„Å§',kun:'„ÇÅ„Åå„Åß„Çã'},
  {n:46,c:'Â±±',s:3,en:'mountain',ru:'–≥–æ—Ä–∞',de:'Berg',fr:'montagne',ja:'„ÇÑ„Åæ',kun:'„ÇÑ„Åæ'},
  {n:47,c:'Â∑õ',s:3,en:'river',ru:'—Ä–µ–∫–∞',de:'Fluss',fr:'rivi√®re',ja:'„Åæ„Åå„Çä„Åå„Çè',kun:'„Åã„Çè'},
  {n:48,c:'Â∑•',s:3,en:'work',ru:'—Ä–∞–±–æ—Ç–∞',de:'Arbeit',fr:'travail',ja:'„Åü„Åè„Åø',kun:'„Åü„Åè„Åø'},
  {n:49,c:'Â∑±',s:3,en:'self',ru:'—Å–∞–º',de:'sich',fr:'soi-m√™me',ja:'„Åä„ÅÆ„Çå',kun:'„Åä„ÅÆ„Çå'},
  {n:50,c:'Â∑æ',s:3,en:'cloth',ru:'—Ç–∫–∞–Ω—å',de:'Tuch',fr:'tissu',ja:'„ÅØ„Å∞',kun:'„Å¨„ÅÆ'},
  {n:51,c:'Âπ≤',s:3,en:'dry',ru:'—Å—É—Ö–æ–π',de:'trocken',fr:'sec',ja:'„Åª„Åô',kun:'„Åã„Çè„Åã„Åô'},
  {n:52,c:'Âπ∫',s:3,en:'tiny',ru:'–∫—Ä–æ—à–µ—á–Ω—ã–π',de:'winzig',fr:'minuscule',ja:'„Çà„ÅÜ',kun:'„ÅÑ„Å®„Åå„Åó„Çâ'},
  {n:53,c:'Âπø',s:3,en:'shelter',ru:'—É–∫—Ä—ã—Ç–∏–µ',de:'Unterstand',fr:'abri',ja:'„Åæ„Å†„Çå',kun:'„ÅÆ„Åç'},
  {n:54,c:'Âª¥',s:3,en:'stride',ru:'—à–∞–≥–∞—Ç—å',de:'schreiten',fr:'enjamber',ja:'„Åà„Çì„Å´„Çá„ÅÜ',kun:'„ÅÆ„Å∞„Åô'},
  {n:55,c:'Âªæ',s:3,en:'two hands',ru:'–¥–≤–µ —Ä—É–∫–∏',de:'zwei H√§nde',fr:'deux mains',ja:'„Å´„Åò„ÇÖ„ÅÜ„ÅÇ„Åó',kun:'„Åì„Åæ„Å¨„Åç'},
  {n:56,c:'Âºã',s:3,en:'ceremony',ru:'–æ–±—Ä—è–¥',de:'Zeremonie',fr:'c√©r√©monie',ja:'„Çà„Åè',kun:'„Å®„ÇÅ„Çã'},
  {n:57,c:'Âºì',s:3,en:'bow',ru:'–ª—É–∫',de:'Bogen',fr:'arc',ja:'„ÇÜ„Åø',kun:'„ÇÜ„Åø'},
  {n:58,c:'ÂΩê',s:3,en:'snout',ru:'—Ä—ã–ª–æ',de:'Schnauze',fr:'museau',ja:'„Åë„ÅÑ„Åå„Åó„Çâ',kun:'„Åè„Å°„Å∞„Åó'},
  {n:59,c:'ÂΩ°',s:3,en:'bristle',ru:'—â–µ—Ç–∏–Ω–∞',de:'Borste',fr:'poil',ja:'„Åï„Çì„Å•„Åè„Çä',kun:'„Åã„Åø„ÅÆ„Åë'},
  {n:60,c:'ÂΩ≥',s:3,en:'step',ru:'—à–∞–≥',de:'Schritt',fr:'pas',ja:'„Åé„Çá„ÅÜ„Å´„Çì„Åπ„Çì',kun:'„ÇÜ„Åè'},
  // 4 strokes
  {n:61,c:'ÂøÉ',s:4,en:'heart',ru:'—Å–µ—Ä–¥—Ü–µ',de:'Herz',fr:'c≈ìur',ja:'„Åì„Åì„Çç',kun:'„Åì„Åì„Çç'},
  {n:62,c:'Êàà',s:4,en:'halberd',ru:'–∞–ª–µ–±–∞—Ä–¥–∞',de:'Hellebarde',fr:'hallebarde',ja:'„Åª„Åì',kun:'„Åª„Åì'},
  {n:63,c:'Êà∂',s:4,en:'door',ru:'–¥–≤–µ—Ä—å',de:'T√ºr',fr:'porte',ja:'„Å®„Å≥„Çâ',kun:'„Å®'},
  {n:64,c:'Êâã',s:4,en:'hand',ru:'—Ä—É–∫–∞',de:'Hand',fr:'main',ja:'„Å¶',kun:'„Å¶'},
  {n:65,c:'ÊîØ',s:4,en:'branch',ru:'–≤–µ—Ç–≤—å',de:'Zweig',fr:'branche',ja:'„Åó',kun:'„Åà„Å†'},
  {n:66,c:'Êî¥',s:4,en:'strike',ru:'—É–¥–∞—Ä',de:'Schlag',fr:'frapper',ja:'„Åº„Åè„Å´„Çá„ÅÜ',kun:'„Åü„Åü„Åè'},
  {n:67,c:'Êñá',s:4,en:'script',ru:'–ø–∏—Å—å–º–æ',de:'Schrift',fr:'√©criture',ja:'„Å∂„Çì',kun:'„Åµ„Åø'},
  {n:68,c:'Êñó',s:4,en:'dipper',ru:'–∫–æ–≤—à',de:'Sch√∂pfkelle',fr:'louche',ja:'„Å®„Åæ„Åô',kun:'„Åæ„Åô'},
  {n:69,c:'Êñ§',s:4,en:'axe',ru:'—Ç–æ–ø–æ—Ä',de:'Axt',fr:'hache',ja:'„Åä„ÅÆ',kun:'„Åä„ÅÆ'},
  {n:70,c:'Êñπ',s:4,en:'square',ru:'–∫–≤–∞–¥—Ä–∞—Ç',de:'Viereck',fr:'carr√©',ja:'„Åª„ÅÜ',kun:'„Åã„Åü'},
  {n:71,c:'Êó†',s:4,en:'not',ru:'–Ω–µ—Ç',de:'nicht',fr:'non',ja:'„ÇÄ',kun:'„Å™„ÅÑ'},
  {n:72,c:'Êó•',s:4,en:'sun',ru:'—Å–æ–ª–Ω—Ü–µ',de:'Sonne',fr:'soleil',ja:'„Å≤',kun:'„Å≤'},
  {n:73,c:'Êõ∞',s:4,en:'say',ru:'–≥–æ–≤–æ—Ä–∏—Ç—å',de:'sagen',fr:'dire',ja:'„ÅÑ„Çè„Åè',kun:'„ÅÑ„ÅÜ'},
  {n:74,c:'Êúà',s:4,en:'moon',ru:'–ª—É–Ω–∞',de:'Mond',fr:'lune',ja:'„Å§„Åç',kun:'„Å§„Åç'},
  {n:75,c:'Êú®',s:4,en:'tree',ru:'–¥–µ—Ä–µ–≤–æ',de:'Baum',fr:'arbre',ja:'„Åç',kun:'„Åç'},
  {n:76,c:'Ê¨†',s:4,en:'lack',ru:'–Ω–µ—Ö–≤–∞—Ç–∫–∞',de:'Mangel',fr:'manque',ja:'„ÅÇ„Åè„Å≥',kun:'„ÅÇ„Åè„Å≥'},
  {n:77,c:'Ê≠¢',s:4,en:'stop',ru:'—Å—Ç–æ–ø',de:'stopp',fr:'arr√™t',ja:'„Å®„Åæ„Çã',kun:'„Å®„Åæ„Çã'},
  {n:78,c:'Ê≠π',s:4,en:'death',ru:'—Å–º–µ—Ä—Ç—å',de:'Tod',fr:'mort',ja:'„Åå„Å§„Å∏„Çì',kun:'„Åã„Å∞„Å≠'},
  {n:79,c:'ÊÆ≥',s:4,en:'weapon',ru:'–æ—Ä—É–∂–∏–µ',de:'Waffe',fr:'arme',ja:'„Çã„Åæ„Åü',kun:'„Åª„Åì'},
  {n:80,c:'ÊØã',s:4,en:'not',ru:'–Ω–µ',de:'nicht',fr:'ne pas',ja:'„ÅØ„ÅØ',kun:'„Å™„Åã„Çå'},
  {n:81,c:'ÊØî',s:4,en:'compare',ru:'—Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å',de:'vergleichen',fr:'comparer',ja:'„Åè„Çâ„Åπ„Çã',kun:'„Åè„Çâ„Åπ„Çã'},
  {n:82,c:'ÊØõ',s:4,en:'fur',ru:'—à–µ—Ä—Å—Ç—å',de:'Pelz',fr:'fourrure',ja:'„Åë',kun:'„Åë'},
  {n:83,c:'Ê∞è',s:4,en:'clan',ru:'–∫–ª–∞–Ω',de:'Klan',fr:'clan',ja:'„ÅÜ„Åò',kun:'„ÅÜ„Åò'},
  {n:84,c:'Ê∞î',s:4,en:'steam',ru:'–ø–∞—Ä',de:'Dampf',fr:'vapeur',ja:'„Åç„Åå„Åæ„Åà',kun:'„Åç'},
  {n:85,c:'Ê∞¥',s:4,en:'water',ru:'–≤–æ–¥–∞',de:'Wasser',fr:'eau',ja:'„Åø„Åö',kun:'„Åø„Åö'},
  {n:86,c:'ÁÅ´',s:4,en:'fire',ru:'–æ–≥–æ–Ω—å',de:'Feuer',fr:'feu',ja:'„Å≤',kun:'„Å≤'},
  {n:87,c:'Áà™',s:4,en:'claw',ru:'–∫–æ–≥–æ—Ç—å',de:'Klaue',fr:'griffe',ja:'„Å§„ÇÅ',kun:'„Å§„ÇÅ'},
  {n:88,c:'Áà∂',s:4,en:'father',ru:'–æ—Ç–µ—Ü',de:'Vater',fr:'p√®re',ja:'„Å°„Å°',kun:'„Å°„Å°'},
  {n:89,c:'Áàª',s:4,en:'lines',ru:'—á–µ—Ä—Ç—ã',de:'Linien',fr:'lignes',ja:'„Åì„ÅÜ„Åå„Åó„Çâ',kun:'„Åæ„Åò„Çè„Çã'},
  {n:90,c:'Áàø',s:4,en:'half wood',ru:'–ø–æ–ª—É–¥–µ—Ä–µ–≤–æ',de:'halbes Holz',fr:'demi-bois',ja:'„Åó„Çá„ÅÜ„Å∏„Çì',kun:'„Åµ„Åõ„Åé'},
  {n:91,c:'Áâá',s:4,en:'slice',ru:'–ª–æ–º–æ—Ç—å',de:'Scheibe',fr:'tranche',ja:'„Åã„Åü„Å∏„Çì',kun:'„Å≤„Çâ'},
  {n:92,c:'Áâô',s:4,en:'fang',ru:'–∫–ª—ã–∫',de:'Zahn',fr:'croc',ja:'„Åç„Å∞',kun:'„Åç„Å∞'},
  {n:93,c:'Áâõ',s:4,en:'cow',ru:'–∫–æ—Ä–æ–≤–∞',de:'Kuh',fr:'vache',ja:'„ÅÜ„Åó',kun:'„ÅÜ„Åó'},
  {n:94,c:'Áä¨',s:4,en:'dog',ru:'—Å–æ–±–∞–∫–∞',de:'Hund',fr:'chien',ja:'„ÅÑ„Å¨',kun:'„ÅÑ„Å¨'},
  // 5 strokes
  {n:95,c:'ÁéÑ',s:5,en:'dark',ru:'—Ç—ë–º–Ω—ã–π',de:'dunkel',fr:'sombre',ja:'„Åè„Çç',kun:'„Åí„Çì'},
  {n:96,c:'Áéâ',s:5,en:'jade',ru:'–Ω–µ—Ñ—Ä–∏—Ç',de:'Jade',fr:'jade',ja:'„Åü„Åæ',kun:'„Åü„Åæ'},
  {n:97,c:'Áìú',s:5,en:'melon',ru:'–¥—ã–Ω—è',de:'Melone',fr:'melon',ja:'„ÅÜ„Çä',kun:'„ÅÜ„Çä'},
  {n:98,c:'Áì¶',s:5,en:'tile',ru:'—á–µ—Ä–µ–ø–∏—Ü–∞',de:'Dachziegel',fr:'tuile',ja:'„Åã„Çè„Çâ',kun:'„Åã„Çè„Çâ'},
  {n:99,c:'Áîò',s:5,en:'sweet',ru:'—Å–ª–∞–¥–∫–∏–π',de:'s√º√ü',fr:'doux',ja:'„ÅÇ„Åæ„ÅÑ',kun:'„ÅÇ„Åæ„ÅÑ'},
  {n:100,c:'Áîü',s:5,en:'life',ru:'–∂–∏–∑–Ω—å',de:'Leben',fr:'vie',ja:'„ÅÑ„Åç„Çã',kun:'„ÅÜ„Åæ„Çå„Çã'},
  {n:101,c:'Áî®',s:5,en:'use',ru:'–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å',de:'benutzen',fr:'utiliser',ja:'„ÇÇ„Å°„ÅÑ„Çã',kun:'„ÇÇ„Å°„ÅÑ„Çã'},
  {n:102,c:'Áî∞',s:5,en:'field',ru:'–ø–æ–ª–µ',de:'Feld',fr:'champ',ja:'„Åü',kun:'„Åü'},
  {n:103,c:'Áñã',s:5,en:'bolt',ru:'–∫–∏–ø–∞',de:'Ballen',fr:'ballot',ja:'„Å≤„Åç',kun:'„ÅÇ„Åó'},
  {n:104,c:'Áñí',s:5,en:'illness',ru:'–±–æ–ª–µ–∑–Ω—å',de:'Krankheit',fr:'maladie',ja:'„ÇÑ„Åæ„ÅÑ„Å†„Çå',kun:'„ÇÑ„Åæ„ÅÑ'},
  {n:105,c:'Áô∂',s:5,en:'footsteps',ru:'—Å–ª–µ–¥—ã',de:'Schritte',fr:'traces',ja:'„ÅØ„Å§„Åå„Åó„Çâ',kun:'„ÅÇ„Åó'},
  {n:106,c:'ÁôΩ',s:5,en:'white',ru:'–±–µ–ª—ã–π',de:'wei√ü',fr:'blanc',ja:'„Åó„Çç',kun:'„Åó„Çç'},
  {n:107,c:'ÁöÆ',s:5,en:'skin',ru:'–∫–æ–∂–∞',de:'Haut',fr:'peau',ja:'„Åë„Åå„Çè',kun:'„Åã„Çè'},
  {n:108,c:'Áöø',s:5,en:'dish',ru:'–±–ª—é–¥–æ',de:'Teller',fr:'assiette',ja:'„Åï„Çâ',kun:'„Åï„Çâ'},
  {n:109,c:'ÁõÆ',s:5,en:'eye',ru:'–≥–ª–∞–∑',de:'Auge',fr:'≈ìil',ja:'„ÇÅ',kun:'„ÇÅ'},
  {n:110,c:'Áüõ',s:5,en:'spear',ru:'–∫–æ–ø—å—ë',de:'Speer',fr:'lance',ja:'„Åª„Åì',kun:'„Åª„Åì'},
  {n:111,c:'Áü¢',s:5,en:'arrow',ru:'—Å—Ç—Ä–µ–ª–∞',de:'Pfeil',fr:'fl√®che',ja:'„ÇÑ',kun:'„ÇÑ'},
  {n:112,c:'Áü≥',s:5,en:'stone',ru:'–∫–∞–º–µ–Ω—å',de:'Stein',fr:'pierre',ja:'„ÅÑ„Åó',kun:'„ÅÑ„Åó'},
  {n:113,c:'Á§∫',s:5,en:'spirit',ru:'–¥—É—Ö',de:'Geist',fr:'esprit',ja:'„Åó„ÇÅ„Åô',kun:'„Åó„ÇÅ„Åô'},
  {n:114,c:'Á¶∏',s:5,en:'track',ru:'—Å–ª–µ–¥',de:'Spur',fr:'piste',ja:'„Åê„ÅÜ„ÅÆ„ÅÇ„Åó',kun:'„ÅÇ„Åó'},
  {n:115,c:'Á¶æ',s:5,en:'grain',ru:'–∑–µ—Ä–Ω–æ',de:'Getreide',fr:'grain',ja:'„ÅÆ„Åé',kun:'„ÅÑ„Å≠'},
  {n:116,c:'Á©¥',s:5,en:'cave',ru:'–ø–µ—â–µ—Ä–∞',de:'H√∂hle',fr:'caverne',ja:'„ÅÇ„Å™„Åã„Çì„ÇÄ„Çä',kun:'„ÅÇ„Å™'},
  {n:117,c:'Á´ã',s:5,en:'stand',ru:'—Å—Ç–æ—è—Ç—å',de:'stehen',fr:'se tenir',ja:'„Åü„Å§',kun:'„Åü„Å§'},
  // 6 strokes
  {n:118,c:'Á´π',s:6,en:'bamboo',ru:'–±–∞–º–±—É–∫',de:'Bambus',fr:'bambou',ja:'„Åü„Åë',kun:'„Åü„Åë'},
  {n:119,c:'Á±≥',s:6,en:'rice',ru:'—Ä–∏—Å',de:'Reis',fr:'riz',ja:'„Åì„ÇÅ',kun:'„Åì„ÇÅ'},
  {n:120,c:'Á≥∏',s:6,en:'thread',ru:'–Ω–∏—Ç—å',de:'Faden',fr:'fil',ja:'„ÅÑ„Å®',kun:'„ÅÑ„Å®'},
  {n:121,c:'Áº∂',s:6,en:'jar',ru:'–∫—É–≤—à–∏–Ω',de:'Krug',fr:'cruche',ja:'„Åª„Å®„Åé',kun:'„Åã„Çì'},
  {n:122,c:'ÁΩë',s:6,en:'net',ru:'—Å–µ—Ç—å',de:'Netz',fr:'filet',ja:'„ÅÇ„Åø„Åå„Åó„Çâ',kun:'„ÅÇ„Åø'},
  {n:123,c:'Áæä',s:6,en:'sheep',ru:'–æ–≤—Ü–∞',de:'Schaf',fr:'mouton',ja:'„Å≤„Å§„Åò',kun:'„Å≤„Å§„Åò'},
  {n:124,c:'ÁæΩ',s:6,en:'feather',ru:'–ø–µ—Ä–æ',de:'Feder',fr:'plume',ja:'„ÅØ',kun:'„ÅØ'},
  {n:125,c:'ËÄÅ',s:6,en:'old',ru:'—Å—Ç–∞—Ä—ã–π',de:'alt',fr:'vieux',ja:'„Åä„ÅÑ„Çã',kun:'„Åä„ÅÑ„Çã'},
  {n:126,c:'ËÄå',s:6,en:'and',ru:'–∏',de:'und',fr:'et',ja:'„Åó„Åã„Åó„Å¶',kun:'„Åó„Åã„ÇÇ'},
  {n:127,c:'ËÄí',s:6,en:'plow',ru:'–ø–ª—É–≥',de:'Pflug',fr:'charrue',ja:'„Çâ„ÅÑ„Åô„Åç',kun:'„Åô„Åç'},
  {n:128,c:'ËÄ≥',s:6,en:'ear',ru:'—É—Ö–æ',de:'Ohr',fr:'oreille',ja:'„Åø„Åø',kun:'„Åø„Åø'},
  {n:129,c:'ËÅø',s:6,en:'brush',ru:'–∫–∏—Å—Ç—å',de:'Pinsel',fr:'pinceau',ja:'„Åµ„Åß',kun:'„Åµ„Åß'},
  {n:130,c:'ËÇâ',s:6,en:'meat',ru:'–º—è—Å–æ',de:'Fleisch',fr:'viande',ja:'„Å´„Åè',kun:'„Å´„Åè'},
  {n:131,c:'Ëá£',s:6,en:'minister',ru:'–º–∏–Ω–∏—Å—Ç—Ä',de:'Minister',fr:'ministre',ja:'„Åó„Çì',kun:'„Åä„Åø'},
  {n:132,c:'Ëá™',s:6,en:'self',ru:'—Å–∞–º',de:'selbst',fr:'soi',ja:'„Åø„Åö„Åã„Çâ',kun:'„Åø„Åö„Åã„Çâ'},
  {n:133,c:'Ëá≥',s:6,en:'arrive',ru:'–ø—Ä–∏–±—ã—Ç—å',de:'ankommen',fr:'arriver',ja:'„ÅÑ„Åü„Çã',kun:'„ÅÑ„Åü„Çã'},
  {n:134,c:'Ëáº',s:6,en:'mortar',ru:'—Å—Ç—É–ø–∞',de:'M√∂rser',fr:'mortier',ja:'„ÅÜ„Åô',kun:'„ÅÜ„Åô'},
  {n:135,c:'Ëàå',s:6,en:'tongue',ru:'—è–∑—ã–∫',de:'Zunge',fr:'langue',ja:'„Åó„Åü',kun:'„Åó„Åü'},
  {n:136,c:'Ëàõ',s:6,en:'oppose',ru:'–ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π',de:'entgegengesetzt',fr:'oppos√©',ja:'„ÇÇ„Å®„Çã',kun:'„Åæ„ÅÑ„ÅÇ„Åó'},
  {n:137,c:'Ëàü',s:6,en:'boat',ru:'–ª–æ–¥–∫–∞',de:'Boot',fr:'bateau',ja:'„Åµ„Å≠',kun:'„Åµ„Å≠'},
  {n:138,c:'ËâÆ',s:6,en:'stopping',ru:'–æ—Å—Ç–∞–Ω–æ–≤–∫–∞',de:'Stopp',fr:'arr√™t',ja:'„ÅÜ„Åó„Å®„Çâ',kun:'„Åì„Çì„Å´„Çá„ÅÜ'},
  {n:139,c:'Ëâ≤',s:6,en:'color',ru:'—Ü–≤–µ—Ç',de:'Farbe',fr:'couleur',ja:'„ÅÑ„Çç',kun:'„ÅÑ„Çç'},
  {n:140,c:'Ëâ∏',s:6,en:'grass',ru:'—Ç—Ä–∞–≤–∞',de:'Gras',fr:'herbe',ja:'„Åè„Åï„Åã„Çì„ÇÄ„Çä',kun:'„Åè„Åï'},
  {n:141,c:'Ëôç',s:6,en:'tiger',ru:'—Ç–∏–≥—Ä',de:'Tiger',fr:'tigre',ja:'„Å®„Çâ„Åå„Åó„Çâ',kun:'„Å®„Çâ'},
  {n:142,c:'Ëô´',s:6,en:'insect',ru:'–Ω–∞—Å–µ–∫–æ–º–æ–µ',de:'Insekt',fr:'insecte',ja:'„ÇÄ„Åó',kun:'„ÇÄ„Åó'},
  {n:143,c:'Ë°Ä',s:6,en:'blood',ru:'–∫—Ä–æ–≤—å',de:'Blut',fr:'sang',ja:'„Å°',kun:'„Å°'},
  {n:144,c:'Ë°å',s:6,en:'walk',ru:'—Ö–æ–¥–∏—Ç—å',de:'gehen',fr:'marcher',ja:'„ÇÜ„Åè',kun:'„ÅÑ„Åè'},
  {n:145,c:'Ë°£',s:6,en:'clothes',ru:'–æ–¥–µ–∂–¥–∞',de:'Kleidung',fr:'v√™tements',ja:'„Åì„Çç„ÇÇ',kun:'„Åì„Çç„ÇÇ'},
  {n:146,c:'Ë•ø',s:6,en:'west',ru:'–∑–∞–ø–∞–¥',de:'West',fr:'ouest',ja:'„Å´„Åó',kun:'„Å´„Åó'},
  // 7 strokes
  {n:147,c:'Ë¶ã',s:7,en:'see',ru:'–≤–∏–¥–µ—Ç—å',de:'sehen',fr:'voir',ja:'„Åø„Çã',kun:'„Åø„Çã'},
  {n:148,c:'Ëßí',s:7,en:'horn',ru:'—Ä–æ–≥',de:'Horn',fr:'corne',ja:'„Å§„ÅÆ',kun:'„Åã„Å©'},
  {n:149,c:'Ë®Ä',s:7,en:'speech',ru:'—Ä–µ—á—å',de:'Sprache',fr:'parole',ja:'„ÅÑ„ÅÜ',kun:'„Åì„Å®„Å∞'},
  {n:150,c:'Ë∞∑',s:7,en:'valley',ru:'–¥–æ–ª–∏–Ω–∞',de:'Tal',fr:'vall√©e',ja:'„Åü„Å´',kun:'„Åü„Å´'},
  {n:151,c:'Ë±Ü',s:7,en:'bean',ru:'–±–æ–±',de:'Bohne',fr:'haricot',ja:'„Åæ„ÇÅ',kun:'„Åæ„ÇÅ'},
  {n:152,c:'Ë±ï',s:7,en:'pig',ru:'—Å–≤–∏–Ω—å—è',de:'Schwein',fr:'porc',ja:'„ÅÑ„ÅÆ„Åì',kun:'„ÅÑ„ÅÆ„Åì'},
  {n:153,c:'Ë±∏',s:7,en:'badger',ru:'–±–∞—Ä—Å—É–∫',de:'Dachs',fr:'blaireau',ja:'„ÇÄ„Åò„Å™',kun:'„Åà„ÇÇ„ÅÆ„Å∏„Çì'},
  {n:154,c:'Ë≤ù',s:7,en:'shell',ru:'—Ä–∞–∫—É—à–∫–∞',de:'Muschel',fr:'coquille',ja:'„Åã„ÅÑ',kun:'„Åã„ÅÑ'},
  {n:155,c:'Ëµ§',s:7,en:'red',ru:'–∫—Ä–∞—Å–Ω—ã–π',de:'rot',fr:'rouge',ja:'„ÅÇ„Åã',kun:'„ÅÇ„Åã'},
  {n:156,c:'Ëµ∞',s:7,en:'run',ru:'–±–µ–∂–∞—Ç—å',de:'rennen',fr:'courir',ja:'„ÅØ„Åó„Çã',kun:'„ÅØ„Åó„Çã'},
  {n:157,c:'Ë∂≥',s:7,en:'foot',ru:'–Ω–æ–≥–∞ (—Å—Ç–æ–ø–∞)',de:'Fu√ü',fr:'pied',ja:'„ÅÇ„Åó',kun:'„ÅÇ„Åó'},
  {n:158,c:'Ë∫´',s:7,en:'body',ru:'—Ç–µ–ª–æ',de:'K√∂rper',fr:'corps',ja:'„Åø',kun:'„Åø'},
  {n:159,c:'Ëªä',s:7,en:'cart',ru:'—Ç–µ–ª–µ–≥–∞',de:'Wagen',fr:'charrette',ja:'„Åè„Çã„Åæ',kun:'„Åè„Çã„Åæ'},
  {n:160,c:'Ëæõ',s:7,en:'bitter',ru:'–≥–æ—Ä—å–∫–∏–π',de:'bitter',fr:'amer',ja:'„Åã„Çâ„ÅÑ',kun:'„Å§„Çâ„ÅÑ'},
  {n:161,c:'Ëæ∞',s:7,en:'morning',ru:'—É—Ç—Ä–æ',de:'Morgen',fr:'matin',ja:'„Åü„Å§',kun:'„Å®„Åç„Å©„Åç'},
  {n:162,c:'Ëæ∂',s:7,en:'walk',ru:'–∏–¥—Ç–∏',de:'gehen',fr:'marcher',ja:'„Åó„Çì„Å´„Çá„ÅÜ',kun:'„ÇÜ„Åè'},
  {n:163,c:'ÈÇë',s:7,en:'city',ru:'–≥–æ—Ä–æ–¥',de:'Stadt',fr:'ville',ja:'„ÇÄ„Çâ',kun:'„Åè„Å´'},
  {n:164,c:'ÈÖâ',s:7,en:'wine',ru:'–≤–∏–Ω–æ',de:'Wein',fr:'vin',ja:'„Å®„Çä',kun:'„Åï„Åë'},
  {n:165,c:'ÈáÜ',s:7,en:'distinguish',ru:'—Ä–∞–∑–ª–∏—á–∞—Ç—å',de:'unterscheiden',fr:'distinguer',ja:'„ÅÆ„Åî„ÇÅ',kun:'„ÅÆ„Åî„ÇÅ'},
  {n:166,c:'Èáå',s:7,en:'village',ru:'–¥–µ—Ä–µ–≤–Ω—è',de:'Dorf',fr:'village',ja:'„Åï„Å®',kun:'„Åï„Å®'},
  // 8 strokes
  {n:167,c:'Èáë',s:8,en:'gold',ru:'–∑–æ–ª–æ—Ç–æ',de:'Gold',fr:'or',ja:'„Åã„Å≠',kun:'„Åã„Å≠'},
  {n:168,c:'Èï∑',s:8,en:'long',ru:'–¥–ª–∏–Ω–Ω—ã–π',de:'lang',fr:'long',ja:'„Å™„Åå„ÅÑ',kun:'„Å™„Åå„ÅÑ'},
  {n:169,c:'ÈñÄ',s:8,en:'gate',ru:'–≤–æ—Ä–æ—Ç–∞',de:'Tor',fr:'porte',ja:'„Åã„Å©',kun:'„ÇÇ„Çì'},
  {n:170,c:'Èòú',s:8,en:'mound',ru:'–∫—É—Ä–≥–∞–Ω',de:'H√ºgel',fr:'monticule',ja:'„Åä„Åã',kun:'„Åì„Åñ„Å®'},
  {n:171,c:'Èö∂',s:8,en:'slave',ru:'—Ä–∞–±',de:'Sklave',fr:'esclave',ja:'„Çå„ÅÑ',kun:'„Åó„Åü„Åå„ÅÜ'},
  {n:172,c:'Èöπ',s:8,en:'bird',ru:'–ø—Ç–∏—Ü–∞',de:'Vogel',fr:'oiseau',ja:'„Åµ„Çã„Å®„Çä',kun:'„Å®„Çä'},
  {n:173,c:'Èõ®',s:8,en:'rain',ru:'–¥–æ–∂–¥—å',de:'Regen',fr:'pluie',ja:'„ÅÇ„ÇÅ',kun:'„ÅÇ„ÇÅ'},
  {n:174,c:'Èùí',s:8,en:'blue',ru:'—Å–∏–Ω–∏–π',de:'blau',fr:'bleu',ja:'„ÅÇ„Åä',kun:'„ÅÇ„Åä'},
  {n:175,c:'Èùû',s:8,en:'wrong',ru:'–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π',de:'falsch',fr:'faux',ja:'„ÅÇ„Çâ„Åö',kun:'„Åù„ÅÜ„Åß„Å™„ÅÑ'},
  // 9 strokes
  {n:176,c:'Èù¢',s:9,en:'face',ru:'–ª–∏—Ü–æ',de:'Gesicht',fr:'visage',ja:'„Åä„ÇÇ',kun:'„Åã„Åä'},
  {n:177,c:'Èù©',s:9,en:'leather',ru:'–∫–æ–∂–∞ (–∏–∑–¥–µ–ª–∏–µ)',de:'Leder',fr:'cuir',ja:'„Åã„Çè',kun:'„Åã„Çè'},
  {n:178,c:'Èüã',s:9,en:'soft leather',ru:'–º—è–≥–∫–∞—è –∫–æ–∂–∞',de:'weiches Leder',fr:'cuir souple',ja:'„Å™„ÇÅ„Åó„Åå„Çè',kun:'„Å™„ÇÅ„Åó„Åå„Çè'},
  {n:179,c:'Èü≠',s:9,en:'leek',ru:'–ª—É–∫-–ø–æ—Ä–µ–π',de:'Lauch',fr:'poireau',ja:'„Å´„Çâ',kun:'„Å´„Çâ'},
  {n:180,c:'Èü≥',s:9,en:'sound',ru:'–∑–≤—É–∫',de:'Klang',fr:'son',ja:'„Åä„Å®',kun:'„Åä„Å®'},
  {n:181,c:'È†Å',s:9,en:'page',ru:'—Å—Ç—Ä–∞–Ω–∏—Ü–∞',de:'Seite',fr:'page',ja:'„Åä„Åä„Åå„ÅÑ',kun:'„Éö„Éº„Ç∏'},
  {n:182,c:'È¢®',s:9,en:'wind',ru:'–≤–µ—Ç–µ—Ä',de:'Wind',fr:'vent',ja:'„Åã„Åú',kun:'„Åã„Åú'},
  {n:183,c:'È£õ',s:9,en:'fly',ru:'–ª–µ—Ç–∞—Ç—å',de:'fliegen',fr:'voler',ja:'„Å®„Å∂',kun:'„Å®„Å∂'},
  {n:184,c:'È£ü',s:9,en:'eat',ru:'–µ—Å—Ç—å',de:'essen',fr:'manger',ja:'„Åó„Çá„Åè',kun:'„Åü„Åπ„Çã'},
  {n:185,c:'È¶ñ',s:9,en:'head',ru:'–≥–æ–ª–æ–≤–∞',de:'Kopf',fr:'t√™te',ja:'„Åè„Å≥',kun:'„Åè„Å≥'},
  {n:186,c:'È¶ô',s:9,en:'fragrant',ru:'–∞—Ä–æ–º–∞—Ç–Ω—ã–π',de:'duftend',fr:'parfum√©',ja:'„Åã„Åä„Çä',kun:'„Åã„Åä„Çä'},
  // 10 strokes
  {n:187,c:'È¶¨',s:10,en:'horse',ru:'–ª–æ—à–∞–¥—å',de:'Pferd',fr:'cheval',ja:'„ÅÜ„Åæ',kun:'„ÅÜ„Åæ'},
  {n:188,c:'È™®',s:10,en:'bone',ru:'–∫–æ—Å—Ç—å',de:'Knochen',fr:'os',ja:'„Åª„Å≠',kun:'„Åª„Å≠'},
  {n:189,c:'È´ò',s:10,en:'tall',ru:'–≤—ã—Å–æ–∫–∏–π',de:'hoch',fr:'haut',ja:'„Åü„Åã„ÅÑ',kun:'„Åü„Åã„ÅÑ'},
  {n:190,c:'È´ü',s:10,en:'hair',ru:'–≤–æ–ª–æ—Å—ã',de:'Haar',fr:'cheveux',ja:'„Åã„Åø„Åå„Åó„Çâ',kun:'„Åã„Åø'},
  {n:191,c:'È¨•',s:10,en:'fight',ru:'–¥—Ä–∞—Ç—å—Å—è',de:'k√§mpfen',fr:'se battre',ja:'„Åü„Åü„Åã„ÅÑ',kun:'„Åü„Åü„Åã„ÅÜ'},
  {n:192,c:'È¨Ø',s:10,en:'herb',ru:'—Ç—Ä–∞–≤–∞',de:'Kraut',fr:'herbe',ja:'„Å°„Çá„ÅÜ',kun:'„Å´„Åä„ÅÑ„Åñ„Åë'},
  {n:193,c:'È¨≤',s:10,en:'cauldron',ru:'–∫–æ—Ç—ë–ª',de:'Kessel',fr:'chaudron',ja:'„Åã„Å™„Åà',kun:'„Åã„Å™„Åà'},
  {n:194,c:'È¨º',s:10,en:'ghost',ru:'–ø—Ä–∏–∑—Ä–∞–∫',de:'Geist',fr:'fant√¥me',ja:'„Åä„Å´',kun:'„Åä„Å´'},
  // 11 strokes
  {n:195,c:'È≠ö',s:11,en:'fish',ru:'—Ä—ã–±–∞',de:'Fisch',fr:'poisson',ja:'„Åï„Åã„Å™',kun:'„Åï„Åã„Å™'},
  {n:196,c:'È≥•',s:11,en:'bird',ru:'–ø—Ç–∏—Ü–∞',de:'Vogel',fr:'oiseau',ja:'„Å®„Çä',kun:'„Å®„Çä'},
  {n:197,c:'Èπµ',s:11,en:'salt',ru:'—Å–æ–ª—å',de:'Salz',fr:'sel',ja:'„Åó„Åä',kun:'„Åó„Åä„Å°'},
  {n:198,c:'Èπø',s:11,en:'deer',ru:'–æ–ª–µ–Ω—å',de:'Hirsch',fr:'cerf',ja:'„Åó„Åã',kun:'„Åó„Åã'},
  {n:199,c:'È∫¶',s:11,en:'wheat',ru:'–ø—à–µ–Ω–∏—Ü–∞',de:'Weizen',fr:'bl√©',ja:'„ÇÄ„Åé',kun:'„ÇÄ„Åé'},
  {n:200,c:'È∫ª',s:11,en:'hemp',ru:'–∫–æ–Ω–æ–ø–ª—è',de:'Hanf',fr:'chanvre',ja:'„ÅÇ„Åï',kun:'„ÅÇ„Åï'},
  // 12 strokes
  {n:201,c:'ÈªÑ',s:12,en:'yellow',ru:'–∂—ë–ª—Ç—ã–π',de:'gelb',fr:'jaune',ja:'„Åç',kun:'„Åç„ÅÑ„Çç'},
  {n:202,c:'Èªç',s:12,en:'millet',ru:'–ø—Ä–æ—Å–æ',de:'Hirse',fr:'millet',ja:'„Åç„Å≥',kun:'„Åç„Å≥'},
  {n:203,c:'Èªí',s:12,en:'black',ru:'—á—ë—Ä–Ω—ã–π',de:'schwarz',fr:'noir',ja:'„Åè„Çç',kun:'„Åè„Çç'},
  {n:204,c:'Èªπ',s:12,en:'embroidery',ru:'–≤—ã—à–∏–≤–∫–∞',de:'Stickerei',fr:'broderie',ja:'„Åµ„Å§',kun:'„Å¨„ÅÑ'},
  // 13 strokes
  {n:205,c:'ÈªΩ',s:13,en:'frog',ru:'–ª—è–≥—É—à–∫–∞',de:'Frosch',fr:'grenouille',ja:'„Åã„Åà„Çã',kun:'„Åã„Åà„Çã'},
  {n:206,c:'Èºé',s:13,en:'tripod',ru:'—Ç—Ä–µ–Ω–æ–∂–Ω–∏–∫',de:'Dreifu√ü',fr:'tr√©pied',ja:'„Åã„Å™„Åà',kun:'„Åã„Å™„Åà'},
  {n:207,c:'Èºì',s:13,en:'drum',ru:'–±–∞—Ä–∞–±–∞–Ω',de:'Trommel',fr:'tambour',ja:'„Å§„Å•„Åø',kun:'„Å§„Å•„Åø'},
  {n:208,c:'Èº†',s:13,en:'rat',ru:'–∫—Ä—ã—Å–∞',de:'Ratte',fr:'rat',ja:'„Å≠„Åö„Åø',kun:'„Å≠„Åö„Åø'},
  // 14 strokes
  {n:209,c:'Èºª',s:14,en:'nose',ru:'–Ω–æ—Å',de:'Nase',fr:'nez',ja:'„ÅØ„Å™',kun:'„ÅØ„Å™'},
  {n:210,c:'ÈΩä',s:14,en:'even',ru:'—Ä–æ–≤–Ω—ã–π',de:'gleich',fr:'√©gal',ja:'„Å≤„Å®„Åó„ÅÑ',kun:'„Åù„Çç„ÅÜ'},
  // 15-17 strokes
  {n:211,c:'ÈΩí',s:15,en:'teeth',ru:'–∑—É–±—ã',de:'Z√§hne',fr:'dents',ja:'„ÅØ',kun:'„ÅØ'},
  {n:212,c:'Èæç',s:16,en:'dragon',ru:'–¥—Ä–∞–∫–æ–Ω',de:'Drachen',fr:'dragon',ja:'„Åü„Å§',kun:'„Çä„ÇÖ„ÅÜ'},
  {n:213,c:'Èæú',s:16,en:'turtle',ru:'—á–µ—Ä–µ–ø–∞—Ö–∞',de:'Schildkr√∂te',fr:'tortue',ja:'„Åã„ÇÅ',kun:'„Åã„ÇÅ'},
  {n:214,c:'Èæ†',s:17,en:'flute',ru:'—Ñ–ª–µ–π—Ç–∞',de:'Fl√∂te',fr:'fl√ªte',ja:'„ÇÑ„Åè',kun:'„Åµ„Åà'},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  APP STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let state = {
  view: 'grid',
  lang: 'en',
  filterStrokes: 0, // 0 = all
  currentIndex: 0,
  brushSize: 3,
  drawMode: 'free', // 'free' or 'over'
  isDrawing: false,
  lastX: 0,
  lastY: 0,
  touchTimer: null,
  touchStart: 0,
  svgCache: {},
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  I18N
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const I18N = {
  en: {
    title: 'Êº¢Â≠óÈÉ®È¶ñ', back: 'List', strokes: 'Strokes:', all: 'All',
    stroke: 'stroke', strokes_pl: 'strokes',
    hint_free: 'Tap briefly to clear ¬∑ Swipe to navigate',
    hint_over: 'Draw over the guide ¬∑ Tap briefly to clear',
    ref: 'Reference',
    meanings: 'Meanings', free: '‚úé Free', trace: '‚óé Trace',
    loading: 'Loading stroke order‚Ä¶',
    radical: 'Radical',
  },
  ru: {
    title: 'Êº¢Â≠óÈÉ®È¶ñ', back: '–°–ø–∏—Å–æ–∫', strokes: '–ß–µ—Ä—Ç:', all: '–í—Å–µ',
    stroke: '—á–µ—Ä—Ç–∞', strokes_pl: '—á–µ—Ä—Ç—ã/—á–µ—Ä—Ç',
    hint_free: '–ö–æ—Ä–æ—Ç–∫–æ –Ω–∞–∂–º–∏ ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å ¬∑ –°–≤–∞–π–ø –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏',
    hint_over: '–†–∏—Å—É–π –ø–æ–≤–µ—Ä—Ö –æ–±—Ä–∞–∑—Ü–∞ ¬∑ –ö–æ—Ä–æ—Ç–∫–æ –Ω–∞–∂–º–∏ ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å',
    ref: '–û–±—Ä–∞–∑–µ—Ü',
    meanings: '–ó–Ω–∞—á–µ–Ω–∏—è', free: '‚úé –°–≤–æ–±–æ–¥–Ω–æ', trace: '‚óé –û–±–≤–æ–¥–∫–∞',
    loading: '–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ä—è–¥–∫–∞ —á–µ—Ä—Ç‚Ä¶',
    radical: '–†–∞–¥–∏–∫–∞–ª',
  },
  de: {
    title: 'Êº¢Â≠óÈÉ®È¶ñ', back: 'Liste', strokes: 'Striche:', all: 'Alle',
    stroke: 'Strich', strokes_pl: 'Striche',
    hint_free: 'Kurz tippen zum L√∂schen ¬∑ Wischen zum Navigieren',
    hint_over: '√úber Vorlage zeichnen ¬∑ Kurz tippen zum L√∂schen',
    ref: 'Vorlage',
    meanings: 'Bedeutungen', free: '‚úé Frei', trace: '‚óé Nachfahren',
    loading: 'Strichreihenfolge l√§dt‚Ä¶',
    radical: 'Radikal',
  },
  fr: {
    title: 'Êº¢Â≠óÈÉ®È¶ñ', back: 'Liste', strokes: 'Traits:', all: 'Tous',
    stroke: 'trait', strokes_pl: 'traits',
    hint_free: 'Tapez bri√®vement pour effacer ¬∑ Glisser pour naviguer',
    hint_over: 'Dessiner sur le mod√®le ¬∑ Tapez bri√®vement pour effacer',
    ref: 'R√©f√©rence',
    meanings: 'Significations', free: '‚úé Libre', trace: '‚óé Calque',
    loading: 'Chargement de l\'ordre des traits‚Ä¶',
    radical: 'Radical',
  },
  ja: {
    title: 'Êº¢Â≠óÈÉ®È¶ñ', back: '‰∏ÄË¶ß', strokes: 'ÁîªÊï∞:', all: 'ÂÖ®',
    stroke: 'Áîª', strokes_pl: 'Áîª',
    hint_free: 'Áü≠„ÅèÊäº„Åó„Å¶Ê∂à„Åô„Éª„Çπ„ÉØ„Ç§„Éó„ÅßÁßªÂãï',
    hint_over: '„Ç¨„Ç§„Éâ„ÅÆ‰∏ä„Å´Êõ∏„Åè„ÉªÁü≠„ÅèÊäº„Åó„Å¶Ê∂à„Åô',
    ref: 'Ë¶ãÊú¨',
    meanings: 'ÊÑèÂë≥', free: '‚úé Ëá™Áî±', trace: '‚óé „Å™„Åû„Çä',
    loading: 'Á≠ÜÈ†ÜË™≠„ÅøËæº„Åø‰∏≠‚Ä¶',
    radical: 'ÈÉ®È¶ñ',
  },
};

function t(key) { return (I18N[state.lang] || I18N.en)[key] || key; }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DOM REFS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const $ = id => document.getElementById(id);
const gridView = $('grid-view');
const studyView = $('study-view');
const radicalGrid = $('radical-grid');
const strokeFilter = $('stroke-filter');
const langSelect = $('lang-select');
const toggleViewBtn = $('toggle-view-btn');
const backBtn = $('back-btn');
const prevBtn = $('prev-btn');
const nextBtn = $('next-btn');
const infoChar = $('info-char');
const infoMeaning = $('info-meaning');
const infoMeta = $('info-meta');
const meaningsRow = $('meanings-row');
const drawCanvas = $('draw-canvas');
const canvasGridEl = $('canvas-grid');
const guideChar = $('guide-char');
const progressFill = $('progress-fill');
const strokeOrderFallback = $('stroke-order-fallback');
const strokeOrderSvg = $('stroke-order-svg');
const strokeLegend = $('stroke-legend');
const refSection = $('ref-section');
const canvasSection = $('canvas-section');
const bThin = $('b-thin');
const bMedium = $('b-medium');
const bThick = $('b-thick');
const modeFree = $('mode-free');
const modeOver = $('mode-over');

let ctx = null;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function init() {
  ctx = drawCanvas.getContext('2d');
  buildStrokeFilter();
  renderGrid();
  setupEventListeners();
  updateLang();

  // ResizeObserver: fires after real layout, works on all mobile browsers
  const ro = new ResizeObserver(() => {
    if (state.view === 'study') resizeCanvas();
  });
  ro.observe(canvasSection);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STROKE FILTER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function buildStrokeFilter() {
  const lang = state.lang;
  strokeFilter.innerHTML = '';
  const allBtn = document.createElement('button');
  allBtn.className = 'sf-btn' + (state.filterStrokes === 0 ? ' active' : '');
  allBtn.textContent = t('all');
  allBtn.onclick = () => { state.filterStrokes = 0; buildStrokeFilter(); renderGrid(); };
  strokeFilter.appendChild(allBtn);

  const counts = [...new Set(RADICALS.map(r=>r.s))].sort((a,b)=>a-b);
  counts.forEach(n => {
    const btn = document.createElement('button');
    btn.className = 'sf-btn' + (state.filterStrokes === n ? ' active' : '');
    btn.textContent = n;
    btn.onclick = () => { state.filterStrokes = n; buildStrokeFilter(); renderGrid(); };
    strokeFilter.appendChild(btn);
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  GRID
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getFilteredRadicals() {
  if (state.filterStrokes === 0) return RADICALS;
  return RADICALS.filter(r => r.s === state.filterStrokes);
}

function renderGrid() {
  const filtered = getFilteredRadicals();
  radicalGrid.innerHTML = '';
  filtered.forEach((r, i) => {
    const card = document.createElement('div');
    card.className = 'radical-card';
    card.innerHTML = `
      <div class="rc-char">${r.c}</div>
      <div class="rc-num">#${r.n}</div>
      <div class="rc-meaning">${getMeaning(r)}</div>
      <div class="rc-strokes">${r.s}${t('stroke')[0]}</div>
    `;
    card.onclick = () => openStudy(r.n - 1);
    radicalGrid.appendChild(card);
  });
}

function getMeaning(r) {
  return r[state.lang] || r.en;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STUDY VIEW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openStudy(globalIndex) {
  state.currentIndex = globalIndex;
  state.view = 'study';
  gridView.classList.add('hidden');
  studyView.classList.remove('hidden');
  renderStudy();
}

function renderStudy() {
  const r = RADICALS[state.currentIndex];
  const meaning = getMeaning(r);

  infoChar.textContent = r.c;
  infoMeaning.textContent = meaning;
  infoMeta.textContent = `#${r.n} ¬∑ ${r.s} ${r.s === 1 ? t('stroke') : t('strokes_pl')}`;

  progressFill.style.width = ((state.currentIndex + 1) / RADICALS.length * 100) + '%';

  renderMeanings(r);
  loadStrokeOrder(r);
  updateGuideChar(r);
  updateCanvasHint();
  resizeCanvas();
  clearCanvas();
}

function renderMeanings(r) {
  meaningsRow.innerHTML = '';
  const langs = ['en','ru','de','fr','ja'];
  const labels = {en:'EN',ru:'RU',de:'DE',fr:'FR',ja:'JA'};
  langs.forEach(l => {
    if (!r[l]) return;
    const item = document.createElement('div');
    item.className = 'meaning-item';
    item.innerHTML = `<span class="meaning-lang">${labels[l]}</span><span class="meaning-text">${r[l]}</span>`;
    meaningsRow.appendChild(item);
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STROKE ORDER (KanjiVG)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function loadStrokeOrder(r) {
  strokeOrderFallback.textContent = r.c;
  strokeOrderFallback.classList.remove('hidden');
  strokeOrderSvg.classList.add('hidden');
  strokeLegend.innerHTML = '';

  const codePoint = r.c.codePointAt(0);
  const hex = codePoint.toString(16).padStart(5, '0');
  const url = `https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg@master/kanji/${hex}.svg`;

  if (state.svgCache[hex]) {
    renderKanjiVG(state.svgCache[hex], r);
    return;
  }

  fetch(url)
    .then(res => { if (!res.ok) throw new Error('not found'); return res.text(); })
    .then(svgText => {
      state.svgCache[hex] = svgText;
      renderKanjiVG(svgText, r);
    })
    .catch(() => {
      // Fallback: show big character
      strokeOrderFallback.classList.remove('hidden');
      strokeOrderSvg.classList.add('hidden');
      buildSimpleLegend(r.s);
    });
}

function renderKanjiVG(svgText, r) {
  const parser = new DOMParser();
  const doc = parser.parseFromString(svgText, 'image/svg+xml');
  const origSvg = doc.querySelector('svg');
  if (!origSvg) { buildSimpleLegend(r.s); return; }

  // Get all stroke paths
  const paths = origSvg.querySelectorAll('path');
  if (paths.length === 0) { buildSimpleLegend(r.s); return; }

  // Build our SVG with colored stroke paths
  const colors = generateStrokeColors(paths.length);
  let svgContent = '';

  paths.forEach((p, i) => {
    const d = p.getAttribute('d');
    if (!d) return;
    const color = colors[i];
    svgContent += `<path d="${d}" fill="none" stroke="${color}" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round" opacity="${0.5 + (i / paths.length) * 0.5}"/>`;
  });

  // Add stroke numbers at start of each path
  paths.forEach((p, i) => {
    const d = p.getAttribute('d');
    if (!d) return;
    const pos = getPathStart(d);
    if (!pos) return;
    svgContent += `<circle cx="${pos.x}" cy="${pos.y}" r="6" fill="${colors[i]}" opacity="0.9"/>`;
    svgContent += `<text x="${pos.x}" y="${pos.y + 4}" text-anchor="middle" font-size="7" fill="white" font-weight="bold" font-family="Arial">${i+1}</text>`;
  });

  strokeOrderSvg.innerHTML = svgContent;
  strokeOrderSvg.setAttribute('viewBox', origSvg.getAttribute('viewBox') || '0 0 109 109');
  strokeOrderFallback.classList.add('hidden');
  strokeOrderSvg.classList.remove('hidden');

  buildColorLegend(paths.length, colors);
}

function getPathStart(d) {
  const m = d.match(/[Mm]\s*([\d.+-]+)[,\s]([\d.+-]+)/);
  if (!m) return null;
  return { x: parseFloat(m[1]), y: parseFloat(m[2]) };
}

function generateStrokeColors(n) {
  const colors = [];
  for (let i = 0; i < n; i++) {
    const hue = (i / n) * 280; // blue‚Üíred spectrum
    colors.push(`hsl(${220 + i * (140/Math.max(n-1,1))},70%,40%)`);
  }
  return colors;
}

function buildColorLegend(n, colors) {
  strokeLegend.innerHTML = '';
  const max = Math.min(n, 8);
  for (let i = 0; i < max; i++) {
    const item = document.createElement('div');
    item.className = 'stroke-legend-item';
    const dot = document.createElement('div');
    dot.className = 'stroke-dot';
    dot.style.background = colors[i];
    dot.textContent = i+1;
    item.appendChild(dot);
    strokeLegend.appendChild(item);
  }
  if (n > 8) {
    const more = document.createElement('div');
    more.className = 'stroke-legend-item';
    more.style.fontSize = '0.65rem';
    more.style.color = 'rgba(90,64,32,0.5)';
    more.textContent = `+${n-8} more`;
    strokeLegend.appendChild(more);
  }
}

function buildSimpleLegend(n) {
  strokeLegend.innerHTML = '';
  const colors = generateStrokeColors(n);
  for (let i = 0; i < n; i++) {
    const item = document.createElement('div');
    item.className = 'stroke-legend-item';
    const dot = document.createElement('div');
    dot.className = 'stroke-dot';
    dot.style.background = colors[i];
    dot.textContent = i+1;
    item.appendChild(dot);
    strokeLegend.appendChild(item);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CANVAS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function resizeCanvas() {
  // setTimeout 0 defers until after WebView finishes layout
  setTimeout(() => {
    const w = canvasSection.offsetWidth;
    const h = canvasSection.offsetHeight;
    if (!w || !h) return;

    drawCanvas.width = w;
    drawCanvas.height = h;
    canvasGridEl.width = w;
    canvasGridEl.height = h;

    const size = Math.round(Math.min(w, h) * 0.45);
    guideChar.style.fontSize = size + 'px';

    drawGridLines();
  }, 0);
}

function drawGridLines() {
  const gctx = canvasGridEl.getContext('2d');
  const w = canvasGridEl.width;
  const h = canvasGridEl.height;
  gctx.clearRect(0, 0, w, h);
  gctx.strokeStyle = 'rgba(180,140,80,0.12)';
  gctx.lineWidth = 1;
  gctx.setLineDash([4, 4]);

  // Center cross
  gctx.beginPath();
  gctx.moveTo(w/2, 0); gctx.lineTo(w/2, h);
  gctx.moveTo(0, h/2); gctx.lineTo(w, h/2);
  gctx.stroke();

  // Diagonal
  gctx.strokeStyle = 'rgba(180,140,80,0.07)';
  gctx.beginPath();
  gctx.moveTo(0,0); gctx.lineTo(w,h);
  gctx.moveTo(w,0); gctx.lineTo(0,h);
  gctx.stroke();
  gctx.setLineDash([]);
}

function updateCanvasHint() {
  canvasSection.dataset.hint = state.drawMode === 'over' ? t('hint_over') : t('hint_free');
}

function updateGuideChar(r) {
  guideChar.textContent = r.c;
  guideChar.style.opacity = state.drawMode === 'over' ? '0.5' : '0.12';
}

function clearCanvas() {
  if (!ctx) return;
  ctx.clearRect(0, 0, drawCanvas.width, drawCanvas.height);
}

function flashClear() {
  const div = document.createElement('div');
  div.className = 'clear-flash';
  canvasSection.appendChild(div);
  setTimeout(() => div.remove(), 300);
  clearCanvas();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DRAWING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getPos(e) {
  const rect = drawCanvas.getBoundingClientRect();
  const src = e.touches ? e.touches[0] : e;
  return { x: src.clientX - rect.left, y: src.clientY - rect.top };
}

function startDraw(e) {
  e.preventDefault();
  state.isDrawing = true;
  state.touchStart = Date.now();
  const pos = getPos(e);
  state.lastX = pos.x;
  state.lastY = pos.y;

  ctx.beginPath();
  ctx.moveTo(pos.x, pos.y);

  // Start timer for tap detection
  state.touchTimer = setTimeout(() => { state.touchTimer = null; }, 250);
}

function draw(e) {
  e.preventDefault();
  if (!state.isDrawing) return;
  // If moved significantly, cancel tap
  const pos = getPos(e);
  const dist = Math.hypot(pos.x - state.lastX, pos.y - state.lastY);

  if (dist < 1) return;
  clearTimeout(state.touchTimer);
  state.touchTimer = null;

  ctx.lineWidth = state.brushSize;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  ctx.strokeStyle = 'rgba(20,12,4,0.88)';
  ctx.shadowColor = 'rgba(0,0,0,0.15)';
  ctx.shadowBlur = 1;

  ctx.beginPath();
  ctx.moveTo(state.lastX, state.lastY);
  ctx.lineTo(pos.x, pos.y);
  ctx.stroke();

  state.lastX = pos.x;
  state.lastY = pos.y;
}

function endDraw(e) {
  e.preventDefault();
  if (!state.isDrawing) return;
  state.isDrawing = false;

  const elapsed = Date.now() - state.touchStart;
  if (state.touchTimer !== null || elapsed < 200) {
    // It was a tap ‚Äî clear
    const pos = getPos({...e, touches: e.changedTouches || null});
    flashClear();
  }
  clearTimeout(state.touchTimer);
  state.touchTimer = null;
}

// Touch swipe for navigation
let swipeStartX = null;
function onTouchStart(e) {
  swipeStartX = e.touches[0].clientX;
  startDraw(e);
}
function onTouchEnd(e) {
  endDraw(e);
  if (swipeStartX !== null) {
    const dx = e.changedTouches[0].clientX - swipeStartX;
    // Only navigate if no drawing happened (quick swipe)
    if (Math.abs(dx) > 60 && Date.now() - state.touchStart < 400) {
      if (dx < 0) navigate(1);
      else navigate(-1);
    }
    swipeStartX = null;
  }
}

function navigate(dir) {
  state.currentIndex = (state.currentIndex + dir + RADICALS.length) % RADICALS.length;
  renderStudy();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  EVENT LISTENERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function setupEventListeners() {
  // Drawing events
  drawCanvas.addEventListener('mousedown', startDraw);
  drawCanvas.addEventListener('mousemove', draw);
  drawCanvas.addEventListener('mouseup', endDraw);
  drawCanvas.addEventListener('mouseleave', endDraw);
  drawCanvas.addEventListener('touchstart', onTouchStart, { passive: false });
  drawCanvas.addEventListener('touchmove', draw, { passive: false });
  drawCanvas.addEventListener('touchend', onTouchEnd, { passive: false });

  // Navigation
  prevBtn.onclick = () => navigate(-1);
  nextBtn.onclick = () => navigate(1);
  backBtn.onclick = () => {
    state.view = 'grid';
    studyView.classList.add('hidden');
    gridView.classList.remove('hidden');
  };

  // Keyboard
  document.addEventListener('keydown', e => {
    if (state.view !== 'study') return;
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') navigate(1);
    if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') navigate(-1);
    if (e.key === ' ' || e.key === 'Escape') flashClear();
    if (e.key === 'Backspace') { state.view='grid'; studyView.classList.add('hidden'); gridView.classList.remove('hidden'); }
  });

  // Language
  langSelect.addEventListener('change', () => {
    state.lang = langSelect.value;
    updateLang();
  });

  // Toggle view
  toggleViewBtn.addEventListener('click', () => {
    if (state.view === 'grid') {
      openStudy(state.currentIndex);
    } else {
      state.view = 'grid';
      studyView.classList.add('hidden');
      gridView.classList.remove('hidden');
    }
  });

  // Brush size
  bThin.onclick = () => setBrush(2, bThin);
  bMedium.onclick = () => setBrush(5, bMedium);
  bThick.onclick = () => setBrush(9, bThick);

  // Mode
  [modeFree, modeOver].forEach(btn => {
    btn.onclick = () => {
      state.drawMode = btn.dataset.mode;
      modeFree.classList.toggle('active', state.drawMode === 'free');
      modeOver.classList.toggle('active', state.drawMode === 'over');
      updateGuideChar(RADICALS[state.currentIndex]);
      updateCanvasHint();
    };
  });

  // Resize
  window.addEventListener('resize', () => {
    if (state.view === 'study') resizeCanvas();
  });
}

function setBrush(size, activeBtn) {
  state.brushSize = size;
  [bThin, bMedium, bThick].forEach(b => b.classList.remove('active'));
  activeBtn.classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  LANG UPDATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateLang() {
  document.getElementById('back-label').textContent = t('back');
  document.getElementById('grid-label').textContent = t('strokes');
  modeFree.textContent = t('free');
  modeOver.textContent = t('trace');
  refSection.dataset.label = t('ref');
  buildStrokeFilter();
  renderGrid();
  if (state.view === 'study') {
    renderStudy();
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  START
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
window.addEventListener('load', init);
window.addEventListener('resize', () => { buildStrokeFilter(); renderGrid(); });
</script>
</body>
</html>
